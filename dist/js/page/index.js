"use strict";define(["jquery","template","swiper","bscroll","lazy","text!../../template/banner.html","text!../../template/weekhot.html","text!../../template/recommed.html","text!../../template/love.html","text!../../template/limitfree.html","text!../../template/special.html","text!../../template/listbook.html","text!../../template/shelf.html","text!../../template/search.html"],function(c,d,h,m,t,r,p,f,x,u,b,g,v,e){c.ajax({url:"/book/index",dataType:"json",success:function(t){d(r,t.items[0].data,".index-banner","html"),new h(".index-banner",{loop:!0,autoplay:{delay:2e3}});var e=new h(".wrap-content",{on:{slideChangeTransitionStart:function(){var t=this.activeIndex;c(".tab_box>span").eq(t).addClass("active").siblings().removeClass("active")}}});c(".tab_box>span").eq(0).addClass("active"),c(".tab_box>span").on("click",function(){e.slideTo(c(this).index())}),d(p,t.items[1],".week-hot","append"),d(f,t.items[2],".recommed","append"),d(x,t.items[3],".girllove","prepend"),d(x,t.items[4],".boylove","prepend"),d(u,t.items[5],".limitfree","append"),d(b,t.items[6],".special","append"),c("img.lazy").lazyload({effect:"fadeIn",failurelimit:100,placeholder:"http://img1.cache.netease.com/house/2015/9/29/2015092915152118128.gif"});var a="上拉加载更多",n="下拉刷新",l="释放加载更多",i="释放刷新",s=1,o=new m(".index-wrap",{probeType:2,click:!0,scrollbar:!0});if(o.on("scroll",function(){this.y<this.maxScrollY-40?c(".index-content").attr("data-up",l):this.y<this.maxScrollY-20?c(".index-content").attr("data-up",a):40<this.y?c(".index-content").attr("data-down",i):20<this.y&&c(".index-content").attr("data-down",n)}),o.on("scrollEnd",function(){c(".index-content").attr("data-up",a),c(".index-content").attr("data-down",n)}),3<s)return c(".index-content").attr("data-up","没有更多数据啦"),!1;o.on("touchEnd",function(){if(3<s)return c(".index-content").attr("data-up","没有更多数据啦"),!1;s++,c.getJSON("/book/list",{page:s},function(t){d(g,t,".list-book"),o.refresh(),c("img.lazy").lazyload({effect:"fadeIn",failurelimit:100,placeholder:"http://img1.cache.netease.com/house/2015/9/29/2015092915152118128.gif"})})}),d(v,t.items[3],".list-content","append"),new m(".list-wrap",{click:!0})}});var a=!0;c(".change-btn").on("click",function(){a?(c(this).addClass("activebtn"),c(".shelf-list").hasClass("change-html")?c(".shelf-list").removeClass("change-html"):c(".shelf-list").addClass("change-html"),a=!1):(c(this).removeClass("activebtn"),c(".shelf-list").hasClass("change-html")?c(".shelf-list").removeClass("change-html"):c(".shelf-list").addClass("change-html"),a=!0)})});